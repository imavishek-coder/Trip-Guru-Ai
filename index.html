<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trip Guru AI - Pro Planner</title>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom Stylesheet -->
    <style>
        /* General Body Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }

        /* Custom Shadow for cards */
        .custom-shadow {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Itinerary Card Styles */
        .iti-card {
            background: white;
            border-left: 4px solid;
            transition: all 0.3s ease-in-out;
        }

        .iti-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        /* Loading Spinner */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Custom Checkbox Style */
        .custom-checkbox:checked {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }

        .custom-checkbox:checked + label {
            color: #1e40af;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            max-width: 90%;
            width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <!-- React app will be rendered here -->
    <div id="root"></div>

    <!-- React and Babel for JSX -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Your React Script -->
    <script type="text/babel">
        const { useState } = React;

        // Modal Component
        const Modal = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal-content" onClick={e => e.stopPropagation()}>
                        <div className="flex justify-between items-center mb-4">
                            <h2 className="text-2xl font-bold text-gray-800">{title}</h2>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
                        </div>
                        <div>{children}</div>
                    </div>
                </div>
            );
        };

        // Main App Component
        function App() {
            // State variables for form inputs and app status
            const [fromDestination, setFromDestination] = useState('');
            const [toDestination, setToDestination] = useState('');
            const [days, setDays] = useState(5);
            const [budget, setBudget] = useState(20000);
            const [interests, setInterests] = useState([]);
            const [isCoupleTrip, setIsCoupleTrip] = useState(false);
            const [itinerary, setItinerary] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');
            const [searchWasCoupleTrip, setSearchWasCoupleTrip] = useState(false);
            
            // States for Gemini features
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [modalTitle, setModalTitle] = useState('');
            const [modalContent, setModalContent] = useState(null);
            const [isFeatureLoading, setIsFeatureLoading] = useState(false);
            
            // States for Geolocation feature
            const [location, setLocation] = useState(null);
            const [locationError, setLocationError] = useState('');
            const [isLocationLoading, setIsLocationLoading] = useState(false);


            const interestOptions = ['Adventure', 'Beaches', 'Mountains', 'Foodie', 'History', 'Relaxation', 'Spiritual', 'Shopping'];
            const cardColors = ['#3b82f6', '#10b981', '#ef4444', '#f97316', '#8b5cf6', '#ec4899', '#6366f1'];

            const handleInterestToggle = (interest) => {
                setInterests(prev =>
                    prev.includes(interest)
                        ? prev.filter(i => i !== interest)
                        : [...prev, interest]
                );
            };

            const openGoogleSearch = (query) => {
                window.open(`https://www.google.com/search?q=${encodeURIComponent(query)}`, '_blank');
            };
            
            // Generic function to call Gemini API
            const callGeminiAPI = async (prompt, expectJson = true) => {
                let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };
                const apiKey = "AIzaSyDTF7vnbqQR81OJf4YB1jEN7yPI66Y1hDM"; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`API error! status: ${response.status}`);
                
                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0) {
                    const rawText = result.candidates[0].content.parts[0].text;
                    if (expectJson) {
                        const cleanedText = rawText.replace(/```json/g, '').replace(/```/g, '').trim();
                        return JSON.parse(cleanedText);
                    }
                    return rawText;
                } else {
                    throw new Error("No content received from AI.");
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!fromDestination || !toDestination) {
                    setError('Please enter both starting and destination cities.');
                    return;
                }
                setLoading(true);
                setError('');
                setItinerary(null);
                setSearchWasCoupleTrip(isCoupleTrip); 

                const couplePromptPart = isCoupleTrip ? "This is a romantic trip for a couple. Please include couple-friendly activities, romantic spots, and suggestions for private dining." : "";

                const prompt = `
                    You are an expert travel planner for India named Trip Guru. Create a personalized travel itinerary.
                    From City: ${fromDestination}
                    To City: ${toDestination}
                    Duration: ${days} days
                    Budget: Approximately ₹${Number(budget).toLocaleString('en-IN')} per person
                    Interests: ${interests.join(', ')}
                    Traveler Type: ${isCoupleTrip ? "Couple" : "General"}
                    Instructions: ${couplePromptPart} Provide a detailed day-by-day plan with specific names of local places. For each day, include a 'Travel Tip' section on how to travel between spots. Suggest local food. Return ONLY as a JSON object: {"tripTitle": "...", "tripSummary": "...", "dailyPlans": [{"day": 1, "title": "...", "summary": "...", "morning": "...", "afternoon": "...", "evening": "...", "food": "...", "travelTip": "..."}]}.
                `;

                try {
                    const parsedItinerary = await callGeminiAPI(prompt);
                    setItinerary(parsedItinerary);
                } catch (err) {
                    console.error("Error in handleSubmit:", err);
                    setError("Sorry, something went wrong while creating your trip plan. Please try again.");
                } finally {
                    setLoading(false);
                }
            };

            const generatePackingList = async () => {
                setIsFeatureLoading(true);
                setModalTitle("Aapki Packing List 🎒");
                setIsModalOpen(true);

                const prompt = `
                    Based on a ${days}-day trip to ${toDestination}, India, with interests in ${interests.join(', ')}, and considering the general weather of the region, generate a personalized packing list.
                    Return the response ONLY as a JSON object in the format: {"Clothing": ["item1", "item2"], "Toiletries": ["item1"], "Electronics": ["item1"], "Documents & Essentials": ["item1"]}.
                `;
                try {
                    const list = await callGeminiAPI(prompt);
                    const content = (
                        <div className="space-y-4">
                            {Object.entries(list).map(([category, items]) => (
                                <div key={category}>
                                    <h3 className="text-lg font-semibold text-gray-700 mb-2">{category}</h3>
                                    <ul className="list-disc list-inside text-gray-600 space-y-1">
                                        {items.map((item, index) => <li key={index}>{item}</li>)}
                                    </ul>
                                </div>
                            ))}
                        </div>
                    );
                    setModalContent(content);
                } catch (err) {
                    setModalContent(<p className="text-red-500">Could not generate the packing list. Please try again.</p>);
                } finally {
                    setIsFeatureLoading(false);
                }
            };
            
            const generateCulturalTips = async () => {
                setIsFeatureLoading(true);
                setModalTitle(`Cultural Tips for ${toDestination} 🙏`);
                setIsModalOpen(true);

                const prompt = `
                    Provide a list of important cultural etiquette tips for a tourist visiting ${toDestination}, India. Focus on greetings, dining, visiting religious places, and general conduct. Keep the tips short, respectful, and easy to remember.
                    Return the response ONLY as a JSON object with keys like "Greetings & Respect", "Dining Etiquette", "At Religious Places", "General Tips", where each key has an array of strings as its value.
                `;
                 try {
                    const tips = await callGeminiAPI(prompt);
                    const content = (
                        <div className="space-y-4">
                            {Object.entries(tips).map(([category, items]) => (
                                <div key={category}>
                                    <h3 className="text-lg font-semibold text-gray-700 mb-2">{category}</h3>
                                    <ul className="list-disc list-inside text-gray-600 space-y-1">
                                        {items.map((item, index) => <li key={index}>{item}</li>)}
                                    </ul>
                                </div>
                            ))}
                        </div>
                    );
                    setModalContent(content);
                } catch (err) {
                    setModalContent(<p className="text-red-500">Could not generate cultural tips. Please try again.</p>);
                } finally {
                    setIsFeatureLoading(false);
                }
            };

            const generateMustTryDishes = async () => {
                setIsFeatureLoading(true);
                setModalTitle(`Must-Try Dishes in ${toDestination} 🍲`);
                setIsModalOpen(true);

                const prompt = `
                    List the top 5 must-try local dishes for a tourist in ${toDestination}, India. For each dish, provide a short, enticing description.
                    Return the response ONLY as a JSON object in the format: {"dishes": [{"name": "Dish Name", "description": "Short description."}]}.
                `;
                 try {
                    const data = await callGeminiAPI(prompt);
                    const content = (
                        <div className="space-y-4">
                            {data.dishes.map((dish, index) => (
                                <div key={index}>
                                    <h3 className="text-lg font-semibold text-gray-700">{dish.name}</h3>
                                    <p className="text-gray-600">{dish.description}</p>
                                </div>
                            ))}
                        </div>
                    );
                    setModalContent(content);
                } catch (err) {
                    setModalContent(<p className="text-red-500">Could not generate dish recommendations. Please try again.</p>);
                } finally {
                    setIsFeatureLoading(false);
                }
            };

            const generateSocialPostcard = async () => {
                setIsFeatureLoading(true);
                setModalTitle(`Your Social Postcard 💌`);
                setIsModalOpen(true);

                const prompt = `
                    Write a short, exciting, and beautiful social media post or postcard text for someone about to travel from ${fromDestination} to ${toDestination} for ${days} days. Mention the excitement for the trip. Keep it under 280 characters.
                    Return the response as a single string of text, without any JSON formatting.
                `;
                 try {
                    const postcardText = await callGeminiAPI(prompt, false);
                    const content = (
                        <div>
                            <textarea id="postcard-text" readOnly className="w-full h-40 p-3 border rounded-lg bg-gray-50 text-gray-700" value={postcardText}></textarea>
                            <button onClick={() => {
                                const textArea = document.getElementById('postcard-text');
                                textArea.select();
                                document.execCommand('copy');
                                alert('Postcard text copied to clipboard!');
                            }} className="mt-4 w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                                Copy Text
                            </button>
                        </div>
                    );
                    setModalContent(content);
                } catch (err) {
                    setModalContent(<p className="text-red-500">Could not generate the postcard. Please try again.</p>);
                } finally {
                    setIsFeatureLoading(false);
                }
            };

            const generateBudgetBreakdown = async () => {
                setIsFeatureLoading(true);
                setModalTitle(`Daily Budget for ${toDestination} 💰`);
                setIsModalOpen(true);

                const prompt = `
                    For a trip to ${toDestination} with a daily budget of ₹${(budget / days).toFixed(0)}, provide a suggested budget breakdown per person.
                    Return the response ONLY as a JSON object with keys like "Food", "Transport", "Activities", "Shopping", with their suggested daily amounts in INR.
                `;
                try {
                    const breakdown = await callGeminiAPI(prompt);
                    const content = (
                        <div className="space-y-3">
                            <p className="text-gray-600">Here's a suggested daily breakdown for your budget of <span className="font-bold">₹{Number(budget / days).toLocaleString('en-IN')}</span> per person:</p>
                            <ul className="list-none space-y-2">
                                {Object.entries(breakdown).map(([category, amount]) => (
                                    <li key={category} className="flex justify-between items-center bg-gray-50 p-3 rounded-lg">
                                        <span className="font-medium text-gray-700">{category}</span>
                                        <span className="font-bold text-green-600">₹{Number(amount).toLocaleString('en-IN')}</span>
                                    </li>
                                ))}
                            </ul>
                        </div>
                    );
                    setModalContent(content);
                } catch (err) {
                    setModalContent(<p className="text-red-500">Could not generate the budget breakdown. Please try again.</p>);
                } finally {
                    setIsFeatureLoading(false);
                }
            };

            const generatePhotoSpots = async () => {
                setIsFeatureLoading(true);
                setModalTitle(`Best Photo Spots in ${toDestination} 📸`);
                setIsModalOpen(true);

                const prompt = `
                    Based on a trip to ${toDestination}, India, list the top 5 most photogenic spots. For each spot, provide a short description and the best time to visit for photos.
                    Return the response ONLY as a JSON object in the format: {"spots": [{"name": "Spot Name", "description": "Short description.", "best_time": "e.g., Sunrise"}]}.
                `;
                try {
                    const data = await callGeminiAPI(prompt);
                    const content = (
                        <div className="space-y-4">
                            {data.spots.map((spot, index) => (
                                <div key={index} className="border-b pb-3">
                                    <h3 className="text-lg font-semibold text-gray-700">{spot.name}</h3>
                                    <p className="text-gray-600 mt-1">{spot.description}</p>
                                    <p className="text-sm text-blue-600 font-medium mt-2">Best Time: {spot.best_time}</p>
                                </div>
                            ))}
                        </div>
                    );
                    setModalContent(content);
                } catch (err) {
                    setModalContent(<p className="text-red-500">Could not generate photo spot suggestions. Please try again.</p>);
                } finally {
                    setIsFeatureLoading(false);
                }
            };

            const generateEmergencyInfo = async () => {
                setIsFeatureLoading(true);
                setModalTitle(`Emergency Info for ${toDestination} 🆘`);
                setIsModalOpen(true);

                const prompt = `
                    For a tourist in ${toDestination}, India, provide crucial emergency information.
                    Return ONLY a JSON object with keys 'Contacts' (an object with 'Police', 'Ambulance', 'Tourist Helpline') and 'Phrases' (an object with English phrases and their Hindi translations like 'Help', 'I am lost', 'I need a doctor').
                `;
                try {
                    const data = await callGeminiAPI(prompt);
                    const content = (
                        <div className="space-y-4">
                            <div>
                                <h3 className="text-lg font-semibold text-gray-700 mb-2">Important Contacts</h3>
                                <ul className="list-none space-y-1">
                                    {Object.entries(data.Contacts).map(([name, number]) => (
                                        <li key={name} className="flex justify-between"><span>{name}:</span> <span className="font-mono font-bold">{number}</span></li>
                                    ))}
                                </ul>
                            </div>
                             <div>
                                <h3 className="text-lg font-semibold text-gray-700 mb-2">Helpful Phrases</h3>
                                <ul className="list-none space-y-1">
                                    {Object.entries(data.Phrases).map(([english, local]) => (
                                        <li key={english} className="flex justify-between"><span>{english}:</span> <span className="font-medium">{local}</span></li>
                                    ))}
                                </ul>
                            </div>
                        </div>
                    );
                    setModalContent(content);
                } catch (err) {
                    setModalContent(<p className="text-red-500">Could not generate emergency info. Please try again.</p>);
                } finally {
                    setIsFeatureLoading(false);
                }
            };

            const generateInsuranceInfo = async () => {
                setIsFeatureLoading(true);
                setModalTitle(`Travel Insurance Helper 🛡️`);
                setIsModalOpen(true);

                const prompt = `
                    Explain in simple terms the main types of travel insurance coverage a person should consider for a ${days}-day domestic trip in India to ${toDestination}.
                    Return the response ONLY as a JSON object in the format: {"insurance_info": [{"type": "Coverage Type", "explanation": "Simple explanation."}]}.
                `;
                try {
                    const data = await callGeminiAPI(prompt);
                    const content = (
                        <div className="space-y-4">
                            {data.insurance_info.map((info, index) => (
                                <div key={index}>
                                    <h3 className="text-lg font-semibold text-gray-700">{info.type}</h3>
                                    <p className="text-gray-600">{info.explanation}</p>
                                </div>
                            ))}
                        </div>
                    );
                    setModalContent(content);
                } catch (err) {
                    setModalContent(<p className="text-red-500">Could not generate insurance information. Please try again.</p>);
                } finally {
                    setIsFeatureLoading(false);
                }
            };

            const generateLocalEvents = async () => {
                setIsFeatureLoading(true);
                setModalTitle(`Local Events in ${toDestination} 🎉`);
                setIsModalOpen(true);

                const prompt = `
                    List any potential local festivals, concerts, or significant events happening in ${toDestination}, India during a generic ${days}-day period.
                    Return the response ONLY as a JSON object in the format: {"events": [{"name": "Event Name", "description": "Short description of the event and its significance."}]}. If no specific major events are known, list some recurring local markets or cultural shows.
                `;
                try {
                    const data = await callGeminiAPI(prompt);
                    const content = (
                        <div className="space-y-4">
                            {data.events.map((event, index) => (
                                <div key={index}>
                                    <h3 className="text-lg font-semibold text-gray-700">{event.name}</h3>
                                    <p className="text-gray-600">{event.description}</p>
                                </div>
                            ))}
                        </div>
                    );
                    setModalContent(content);
                } catch (err) {
                    setModalContent(<p className="text-red-500">Could not find local event information. Please try again.</p>);
                } finally {
                    setIsFeatureLoading(false);
                }
            };

            const generateSouvenirIdeas = async () => {
                setIsFeatureLoading(true);
                setModalTitle(`Souvenir Ideas from ${toDestination} 🎁`);
                setIsModalOpen(true);

                const prompt = `
                    Suggest 5 unique and authentic souvenirs to buy from ${toDestination}, India. For each, provide a short description.
                    Return the response ONLY as a JSON object in the format: {"souvenirs": [{"name": "Souvenir Name", "description": "Short description."}]}.
                `;
                try {
                    const data = await callGeminiAPI(prompt);
                    const content = (
                        <div className="space-y-4">
                            {data.souvenirs.map((souvenir, index) => (
                                <div key={index}>
                                    <h3 className="text-lg font-semibold text-gray-700">{souvenir.name}</h3>
                                    <p className="text-gray-600">{souvenir.description}</p>
                                </div>
                            ))}
                        </div>
                    );
                    setModalContent(content);
                } catch (err) {
                    setModalContent(<p className="text-red-500">Could not generate souvenir ideas. Please try again.</p>);
                } finally {
                    setIsFeatureLoading(false);
                }
            };
            
            const handleFindNearbyHotels = () => {
                setIsLocationLoading(true);
                setLocationError('');
                setLocation(null);

                if (!navigator.geolocation) {
                    setLocationError("Geolocation is not supported by your browser.");
                    setIsLocationLoading(false);
                    return;
                }

                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        setLocation({
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude,
                        });
                        setIsLocationLoading(false);
                    },
                    () => {
                        setLocationError("Unable to retrieve your location. Please enable location services.");
                        setIsLocationLoading(false);
                    }
                );
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 sm:p-6 md:p-8">
                    <Modal isOpen={isModalOpen} onClose={() => setIsModalOpen(false)} title={modalTitle}>
                        {isFeatureLoading ? <div className="flex justify-center"><div className="loader"></div></div> : modalContent}
                    </Modal>

                    <div className="max-w-4xl mx-auto">
                        <header className="text-center mb-10">
                            <h1 className="text-4xl md:text-5xl font-bold text-gray-800 tracking-tight">
                                Trip Guru <span className="text-blue-600">AI</span>
                            </h1>
                            <p className="text-gray-500 mt-2 text-lg">Aapka personal AI-powered travel planner</p>
                        </header>

                        <div className="bg-white p-6 sm:p-8 rounded-2xl custom-shadow mb-10">
                            <form onSubmit={handleSubmit}>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label htmlFor="fromDestination" className="block text-sm font-medium text-gray-700 mb-1">Kahan Se? (Starting City)</label>
                                        <input type="text" id="fromDestination" value={fromDestination} onChange={(e) => setFromDestination(e.target.value)} placeholder="e.g., Delhi" className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" />
                                    </div>
                                    <div>
                                        <label htmlFor="toDestination" className="block text-sm font-medium text-gray-700 mb-1">Kahan Jana Hai? (Destination)</label>
                                        <input type="text" id="toDestination" value={toDestination} onChange={(e) => setToDestination(e.target.value)} placeholder="e.g., Goa" className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" />
                                    </div>
                                    <div>
                                        <label htmlFor="days" className="block text-sm font-medium text-gray-700 mb-1">Kitne Din ke liye</label>
                                        <input type="number" id="days" min="1" value={days} onChange={(e) => setDays(e.target.value)} placeholder="e.g., 5" className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" />
                                    </div>
                                    <div>
                                        <label htmlFor="budget" className="block text-sm font-medium text-gray-700 mb-1">Budget (per person, in ₹)</label>
                                        <input type="number" id="budget" min="500" step="100" value={budget} onChange={(e) => setBudget(e.target.value)} placeholder="e.g., 20000" className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" />
                                    </div>
                                </div>
                                <div className="mt-6">
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Aapki pasand (Interests)</label>
                                    <div className="flex flex-wrap gap-2">
                                        {interestOptions.map(interest => (
                                            <button key={interest} type="button" onClick={() => handleInterestToggle(interest)} className={`px-4 py-2 text-sm rounded-full transition-all duration-200 border-2 ${interests.includes(interest) ? 'bg-blue-600 text-white border-blue-600' : 'bg-white text-gray-700 border-gray-300 hover:border-blue-500'}`}>{interest}</button>
                                        ))}
                                    </div>
                                </div>
                                <div className="mt-6">
                                    <div className="flex items-center">
                                        <input id="couple-checkbox" type="checkbox" checked={isCoupleTrip} onChange={() => setIsCoupleTrip(!isCoupleTrip)} className="h-5 w-5 rounded custom-checkbox border-gray-300 text-blue-600 focus:ring-blue-500 transition" />
                                        <label htmlFor="couple-checkbox" className="ml-3 block text-sm font-medium text-gray-700 transition">Travelling as a couple?</label>
                                    </div>
                                </div>
                                <div className="mt-8 text-center">
                                    <button type="submit" disabled={loading} className="w-full md:w-auto inline-flex justify-center items-center px-12 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-transform transform hover:scale-105 disabled:bg-blue-300 disabled:cursor-not-allowed">
                                        {loading ? 'Aapka Trip Plan ban raha hai...' : '✨ Mera Trip Plan Banao'}
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <div className="bg-white p-6 sm:p-8 rounded-2xl custom-shadow mb-10 text-center">
                            <h2 className="text-2xl font-bold text-gray-800 mb-4">Aas-Paas ke Hotels Dhundein</h2>
                            <p className="text-gray-600 mb-6">Apni current location ka istemal karke turant nazdeeki hotels search karein.</p>
                            
                            {!location && (
                                <button onClick={handleFindNearbyHotels} disabled={isLocationLoading} className="w-full md:w-auto inline-flex justify-center items-center px-8 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-transform transform hover:scale-105 disabled:bg-green-300">
                                    {isLocationLoading ? 'Location le rahe hain...' : '📍 Use My Live Location'}
                                </button>
                            )}

                            {locationError && <p className="text-red-500 mt-4">{locationError}</p>}

                            {location && (
                                <div className="mt-4 flex flex-wrap gap-4 justify-center">
                                    <button onClick={() => openGoogleSearch(`hotels near me`)} className="px-5 py-2 text-base font-medium rounded-full text-white bg-blue-600 hover:bg-blue-700 transition-transform transform hover:scale-105">🏨 Find Nearby Hotels</button>
                                    <button onClick={() => openGoogleSearch(`couple friendly hotels near me`)} className="px-5 py-2 text-base font-medium rounded-full text-white bg-pink-600 hover:bg-pink-700 transition-transform transform hover:scale-105">❤️ Find Couple Friendly Hotels</button>
                                </div>
                            )}
                        </div>


                        <div className="mt-10">
                            {error && <div className="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg" role="alert"><p className="font-bold">Oops!</p><p>{error}</p></div>}
                            {loading && <div className="flex justify-center items-center p-10"><div className="loader"></div></div>}
                            {itinerary && (
                                <div className="bg-white p-6 sm:p-8 rounded-2xl custom-shadow">
                                    <div className="bg-gray-50 p-4 rounded-lg mb-6 flex flex-wrap gap-3 justify-center">
                                        <button onClick={generatePackingList} className="px-4 py-2 text-sm font-medium rounded-full text-white bg-indigo-600 hover:bg-indigo-700 transition-transform transform hover:scale-105">✨ Packing List</button>
                                        <button onClick={generateCulturalTips} className="px-4 py-2 text-sm font-medium rounded-full text-white bg-teal-600 hover:bg-teal-700 transition-transform transform hover:scale-105">✨ Cultural Tips</button>
                                        <button onClick={generateMustTryDishes} className="px-4 py-2 text-sm font-medium rounded-full text-white bg-amber-600 hover:bg-amber-700 transition-transform transform hover:scale-105">✨ Local Dishes</button>
                                        <button onClick={generateSocialPostcard} className="px-4 py-2 text-sm font-medium rounded-full text-white bg-rose-600 hover:bg-rose-700 transition-transform transform hover:scale-105">✨ Social Postcard</button>
                                        <button onClick={generateBudgetBreakdown} className="px-4 py-2 text-sm font-medium rounded-full text-white bg-lime-600 hover:bg-lime-700 transition-transform transform hover:scale-105">✨ Budget Breakdown</button>
                                        <button onClick={generatePhotoSpots} className="px-4 py-2 text-sm font-medium rounded-full text-white bg-cyan-600 hover:bg-cyan-700 transition-transform transform hover:scale-105">✨ Photo Spots</button>
                                        <button onClick={generateEmergencyInfo} className="px-4 py-2 text-sm font-medium rounded-full text-white bg-red-600 hover:bg-red-700 transition-transform transform hover:scale-105">✨ Emergency Info</button>
                                        {/* --- NEW BUTTONS --- */}
                                        <button onClick={generateInsuranceInfo} className="px-4 py-2 text-sm font-medium rounded-full text-white bg-gray-600 hover:bg-gray-700 transition-transform transform hover:scale-105">✨ Insurance Helper</button>
                                        <button onClick={generateLocalEvents} className="px-4 py-2 text-sm font-medium rounded-full text-white bg-purple-600 hover:bg-purple-700 transition-transform transform hover:scale-105">✨ Local Events</button>
                                        <button onClick={generateSouvenirIdeas} className="px-4 py-2 text-sm font-medium rounded-full text-white bg-orange-600 hover:bg-orange-700 transition-transform transform hover:scale-105">✨ Souvenir Ideas</button>
                                    </div>
                                    <h2 className="text-3xl font-bold text-gray-800 mb-2">{itinerary.tripTitle}</h2>
                                    <p className="text-gray-600 mb-8 text-lg">{itinerary.tripSummary}</p>
                                    <div className="space-y-6">
                                        {itinerary.dailyPlans.map((day, index) => (
                                            <div key={day.day} className="iti-card p-5 rounded-lg" style={{ borderColor: cardColors[index % cardColors.length] }}>
                                                <h3 className="text-xl font-bold text-gray-800">Day {day.day}: {day.title}</h3>
                                                <p className="text-gray-500 mt-1 mb-4">{day.summary}</p>
                                                <div className="space-y-3 text-gray-700">
                                                    <p><strong>Subah:</strong> {day.morning}</p>
                                                    <p><strong>Dopeher:</strong> {day.afternoon}</p>
                                                    <p><strong>Shaam:</strong> {day.evening}</p>
                                                    <p><strong>🍴 Khana Peena:</strong> {day.food}</p>
                                                    <p className="mt-2 p-3 bg-blue-50 rounded-lg"><strong>🚌 Travel Tip:</strong> {day.travelTip}</p>
                                                </div>
                                                <div className="mt-4 pt-4 border-t border-gray-200 flex flex-wrap gap-3">
                                                    <button onClick={() => openGoogleSearch(`Best budget hotels in ${toDestination}`)} className="flex items-center px-3 py-1.5 text-sm bg-green-100 text-green-800 rounded-full hover:bg-green-200 transition">
                                                        <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2l-7 7-7-7M19 10v10a1 1 0 01-1 1h-3" /></svg>
                                                        Find Hotels
                                                    </button>
                                                    {searchWasCoupleTrip && (
                                                        <button onClick={() => openGoogleSearch(`Couple friendly hotels in ${toDestination}`)} className="flex items-center px-3 py-1.5 text-sm bg-pink-100 text-pink-800 rounded-full hover:bg-pink-200 transition">
                                                            <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4 mr-1.5" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clipRule="evenodd" /></svg>
                                                            Couple Friendly Hotels
                                                        </button>
                                                    )}
                                                    <button onClick={() => openGoogleSearch(`Top tourist places to visit in ${toDestination}`)} className="flex items-center px-3 py-1.5 text-sm bg-purple-100 text-purple-800 rounded-full hover:bg-purple-200 transition">
                                                        <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                                                        Explore Places
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                        <footer className="text-center mt-12 text-gray-500 text-sm">
                            <p className="mb-2">Powered by Avishek Giri</p>
                            <div className="flex justify-center items-center space-x-2">
                                <span>Made with ❤️ by</span>
                                <a href="https://github.com/imavishek-coder" target="_blank" rel="noopener noreferrer" className="flex items-center font-medium text-gray-700 hover:text-blue-600 transition">
                                    <svg className="w-5 h-5 mr-1.5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                        <path fillRule="evenodd" d="M12 2C6.477 2 2 6.477 2 12c0 4.418 2.865 8.168 6.839 9.492.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.031-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.378.203 2.398.1 2.651.64.7 1.03 1.595 1.03 2.688 0 3.848-2.338 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.001 10.001 0 0022 12c0-5.523-4.477-10-10-10z" clipRule="evenodd" />
                                    </svg>
                                    imavishek-coder
                                </a>
                            </div>
                        </footer>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
